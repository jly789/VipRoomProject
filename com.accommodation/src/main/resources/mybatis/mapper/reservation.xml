<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-/mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="vip.com.accommodation.mapper.reservation.ReservationMapper">


    <select id="maxNum" resultType="int">
        select ifnull(max(reservationId),0) from reservation
    </select>


        <select id="reservationSearch" parameterType="vip.com.accommodation.dto.reservation.ReservationFindDto" resultType="int">
            select count(*) from reservation
                                     left join room on reservation.roomId = room.roomId
            where reservationCheckIn=#{reservationCheckIn}
              and reservationCheckOut =#{reservationCheckOut} and room.roomId=#{roomId}
        </select>





    <insert id="reservationInsert" parameterType="vip.com.accommodation.mapper.reservation.ReservationMapper">

        insert into reservation(reservationId,memberId,accommodationId,roomId,reservationStatus,
                                reservationDetails,reservationCheckIn,reservationCheckOut)
        values (#{reservationId},1,#{accommodationId},#{roomId},'예약중'
               ,#{reservationDetails},#{reservationCheckIn},#{reservationCheckOut})


    </insert>


    <select id="reservationFindDto" parameterType="vip.com.accommodation.dto.reservation.ReservationFindDto" resultType="vip.com.accommodation.dto.reservation.ReservationFindDto">
        select * from reservation
                                 left join room on reservation.roomId = room.roomId
        where reservationCheckIn=#{reservationCheckIn}
          and reservationCheckOut =#{reservationCheckOut} and room.roomId=#{roomId}
    </select>


</mapper>
